<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FreshBite Campus Market</title>
<style>
    /* RESET & GENERAL */
    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }

    body {
        font-family: 'Arial', sans-serif;
        background: url('logo.jpg') no-repeat center center fixed;
        background-size: cover;
        color: #333;
        line-height: 1.5;
    }

    /* HEADER */
    header {
        background: rgba(76, 175, 80, 0.85);
        color: #fff;
        text-align: center;
        padding: 25px 15px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }

    header h1 {
        font-size: 2em;
        margin-bottom: 5px;
    }

    header p {
        font-size: 1em;
    }

    /* CONTAINER */
    .container {
        width: 90%;
        max-width: 500px;
        margin: 25px auto;
        background: rgba(255,255,255,0.95);
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        transition: transform 0.3s ease;
    }

    h2 {
        text-align: center;
        color: #4CAF50;
        margin-bottom: 20px;
    }

    /* INPUTS & BUTTONS */
    input, select, button {
        width: 100%;
        padding: 14px;
        margin: 10px 0;
        border-radius: 8px;
        border: 1px solid #ccc;
        font-size: 1em;
        outline: none;
        transition: all 0.3s ease;
    }

    input:focus, select:focus {
        border-color: #4CAF50;
        box-shadow: 0 0 8px rgba(76,175,80,0.4);
    }

    button {
        background: #4CAF50;
        color: #fff;
        font-weight: bold;
        font-size: 1.1em;
        cursor: pointer;
        transition: background 0.3s ease, transform 0.2s ease;
    }

    button:hover {
        background: #45a049;
        transform: translateY(-2px);
    }

    /* HIDE PANELS INITIALLY */
    #sellerPanel, #buyerPanel {
        display: none;
    }

    /* PRODUCT BOXES */
    .product {
        background: #f9f9f9;
        padding: 15px;
        margin: 12px 0;
        border-radius: 10px;
        border-left: 6px solid #4CAF50;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .product img {
        width: 100%;
        border-radius: 8px;
        margin-bottom: 8px;
    }

    .product button {
        margin-top: 8px;
    }

    /* RESPONSIVE STYLING */
    @media (max-width: 768px) {
        header h1 {
            font-size: 1.6em;
        }
        header p {
            font-size: 0.95em;
        }
        .container {
            padding: 20px;
        }
        input, select, button {
            padding: 12px;
            font-size: 0.95em;
        }
    }

    @media (max-width: 480px) {
        header h1 {
            font-size: 1.4em;
        }
        header p {
            font-size: 0.9em;
        }
        .container {
            padding: 18px;
        }
        input, select, button {
            padding: 10px;
            font-size: 0.9em;
        }
    }
</style>
</head>
<body>

<header>
    <h1>FreshBite Campus Market</h1>
    <p>Affordable Vegetables for Students</p>
</header>

<!-- ROLE SELECTION -->
<div class="container" id="roleSelect">
    <h2>Choose Account Type</h2>
    <button onclick="chooseRole('seller')">I am a Seller</button>
    <button onclick="chooseRole('buyer')">I am a Buyer</button>
</div>

<!-- AUTH SECTION -->
<div class="container" id="authSection" style="display:none;">
    <h2 id="authTitle">Login</h2>
    <input id="name" placeholder="Full Name">
    <input id="email" placeholder="Email">
    <input id="password" type="password" placeholder="Password">
    <input id="whatsapp" placeholder="WhatsApp Number (for sellers)">
    <button onclick="registerUser()">Create Account</button>
    <button onclick="loginUser()">Login</button>
</div>

<!-- SELLER DASHBOARD -->
<div class="container" id="sellerPanel">
    <h2>Seller Dashboard</h2>
    <input id="vegName" placeholder="Vegetable Name">
    <input id="vegPrice" placeholder="Price (GHC)">
    <input type="file" id="vegImage" accept="image/*">
    <button onclick="addVegetable()">Add Vegetable</button>

    <h3>My Vegetables</h3>
    <div id="sellerProducts"></div>
</div>

<!-- BUYER DASHBOARD -->
<div class="container" id="buyerPanel">
    <h2>Buyer Dashboard</h2>
    <h3>Available Vegetables</h3>
    <div id="marketProducts"></div>
</div>

<script>
let selectedRole = "";
let currentUser = "";

function chooseRole(role) {
    selectedRole = role;
    document.getElementById("roleSelect").style.display = "none";
    document.getElementById("authSection").style.display = "block";

    document.getElementById("authTitle").innerText = 
        role === "seller" ? "Seller Login / Register" : "Buyer Login / Register";
}

function registerUser() {
    let user = {
        name: document.getElementById("name").value,
        email: document.getElementById("email").value,
        pass: document.getElementById("password").value,
        role: selectedRole,
        whatsapp: selectedRole === 'seller' ? document.getElementById("whatsapp").value : null
    };

    if(selectedRole==='seller' && !user.whatsapp){
        return alert("Please provide your WhatsApp number!");
    }

    localStorage.setItem(user.email, JSON.stringify(user));
    alert("Account created successfully!");
}

function loginUser() {
    let email = document.getElementById("email").value;
    let pass = document.getElementById("password").value;

    let user = localStorage.getItem(email);
    if (!user) return alert("Account not found!");

    let data = JSON.parse(user);
    if (data.pass !== pass) return alert("Wrong password!");

    currentUser = email;

    if (data.role === "seller") {
        showSellerPanel();
    } else {
        showBuyerPanel();
    }
}

function showSellerPanel() {
    document.getElementById("authSection").style.display = "none";
    document.getElementById("sellerPanel").style.display = "block";
    loadSellerProducts();
}

function showBuyerPanel() {
    document.getElementById("authSection").style.display = "none";
    document.getElementById("buyerPanel").style.display = "block";
    loadMarket();
}

function addVegetable() {
    let name = document.getElementById("vegName").value;
    let price = document.getElementById("vegPrice").value;
    let imageInput = document.getElementById("vegImage");

    if (!name || !price) return alert("Please enter name and price!");

    let sellerData = JSON.parse(localStorage.getItem(currentUser));
    if (!sellerData.whatsapp) return alert("Seller WhatsApp not found!");

    if (imageInput.files && imageInput.files[0]) {
        let reader = new FileReader();
        reader.onload = function(e) {
            let item = {
                seller: currentUser,
                name: name,
                price: price,
                image: e.target.result,
                whatsapp: sellerData.whatsapp
            };
            saveVegetable(item);
        };
        reader.readAsDataURL(imageInput.files[0]);
    } else {
        let item = {
            seller: currentUser,
            name: name,
            price: price,
            image: null,
            whatsapp: sellerData.whatsapp
        };
        saveVegetable(item);
    }
}

function saveVegetable(item) {
    let all = JSON.parse(localStorage.getItem("market") || "[]");
    all.push(item);
    localStorage.setItem("market", JSON.stringify(all));
    alert("Vegetable added!");
    document.getElementById("vegName").value = "";
    document.getElementById("vegPrice").value = "";
    document.getElementById("vegImage").value = "";
    loadSellerProducts();
}

function loadSellerProducts() {
    let all = JSON.parse(localStorage.getItem("market") || "[]");
    let myList = all.filter(v => v.seller === currentUser);

    let box = document.getElementById("sellerProducts");
    box.innerHTML = "";

    myList.forEach(v => {
        box.innerHTML += `<div class='product'>
            ${v.image ? <img src="${v.image}"> : ""}
            <b>${v.name}</b> - GHC ${v.price}
        </div>`;
    });
}

function loadMarket() {
    let all = JSON.parse(localStorage.getItem("market") || "[]");
    let box = document.getElementById("marketProducts");
    box.innerHTML = "";

    all.forEach(v => {
        box.innerHTML += `<div class='product'>
            ${v.image ? <img src="${v.image}"> : ""}
            <b>${v.name}</b> <br>
            Price: GHC ${v.price}<br>
            Seller: ${v.seller}<br>
            <button onclick="buyWhatsApp('${v.whatsapp}','${v.name}','${v.price}')">Buy on WhatsApp</button>
        </div>`;
    });
}

function buyWhatsApp(number, product, price) {
    if (!number) return alert("Seller has not provided WhatsApp!");
    let msg = Hello, I want to buy "${product}" for GHC ${price};
    let url = https://wa.me//+233538387529/${number}?text=${encodeURIComponent(msg)};
    window.open(url, "_blank");
}
</script>

</body>
</html>
